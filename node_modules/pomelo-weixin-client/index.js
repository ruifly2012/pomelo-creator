'use strict';

var Pomelo = require('./lib/Pomelo');
// const WS = require('ws');

function wsCreator(_ref) {
    var url = _ref.url,
        onError = _ref.onError,
        onOpen = _ref.onOpen,
        onMessage = _ref.onMessage,
        onClose = _ref.onClose;

    var ws = wx.connectSocket({ url: url });
    ws.onError(onError);
    ws.onOpen(onOpen);
    ws.onMessage(onMessage);
    ws.onClose(onClose);
    return ws;
}

function wsCreatorWeb(_ref2) {
    var url = _ref2.url,
        onError = _ref2.onError,
        onOpen = _ref2.onOpen,
        onMessage = _ref2.onMessage,
        onClose = _ref2.onClose;

    var ws = new WebSocket(url);
    ws.onerror = onError;
    ws.onopen = onOpen;
    ws.onmessage = onMessage;
    ws.onclose = onClose;
    return ws;
}

function urlGenerator(host, port) {
    var url = 'wss://' + host;
    if (port) {
        url += '/ws/' + port + '/';
    }
    return url;
}

module.exports = new Pomelo({
    wsCreator: wsCreator,
    wsCreatorWeb: wsCreatorWeb,
    urlGenerator: urlGenerator
});
